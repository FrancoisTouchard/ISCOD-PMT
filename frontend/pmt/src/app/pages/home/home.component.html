<nav class="navbar header bg-primary">
  <div class="container-fluid">
    <div>
      <button class="btn btn-danger" (click)="logOutAndRedirect()">
        Déconnexion
      </button>
      <button class="btn btn-light" (click)="openCreateProjectModal()">
        Créer un projet
      </button>
    </div>
  </div>
</nav>

<div *ngIf="modal" class="custom-backdrop">
  <div class="custom-modal">
    <div class="modal-header">
      <h5 class="modal-title">Créer un projet</h5>
      <button type="button" class="btn-close" (click)="closeModal()"></button>
    </div>
    <div class="modal-body">
      <p>Contenu de la modal…</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Annuler</button>
      <button class="btn btn-primary">Valider</button>
    </div>
  </div>
</div>

<div class="container mt-5">
  <h1 class="mb-4">Mes Projets</h1>

  <!-- Message d'erreur -->
  <div
    *ngIf="errorMessage"
    class="alert alert-danger alert-dismissible fade show"
    role="alert"
  >
    {{ errorMessage }}
    <button
      type="button"
      class="btn-close"
      (click)="errorMessage = ''"
    ></button>
  </div>

  <!-- Chargement -->
  <div *ngIf="loading" class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
  </div>

  <!-- Tableau des projets -->
  <div *ngIf="!loading && projets.length > 0" class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>Nom du Projet</th>
          <th>Description</th>
          <th>Date de Début</th>
          <th>Votre Rôle</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let projet of projets">
          <td class="fw-bold">{{ projet.nom }}</td>
          <td>{{ projet.description }}</td>
          <td>{{ projet.dateDebut | date : "dd/MM/yyyy" }}</td>
          <td>
            <span>
              {{ getRoleLabel(projet.contributeurs[0]?.role || "") }}
            </span>
          </td>
          <td>
            <button class="btn btn-sm btn-primary">Voir</button>
            <button
              class="btn btn-sm btn-danger"
              (click)="deleteProject(projet.id)"
            >
              Supprimer
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Aucun projet -->
  <div
    *ngIf="!loading && projets.length === 0"
    class="alert alert-info d-flex flex-column align-items-center"
  >
    <div>
      <strong>Aucun projet</strong> - Vous n'avez aucun projet pour le moment.
    </div>
    <button class="btn btn-primary mt-2">Créer un projet</button>
  </div>
</div>
