<nav class="navbar header bg-primary">
  <div class="container-fluid">
    <div>
      <button class="btn btn-danger" (click)="logOut()">Déconnexion</button>
      <button class="btn btn-light" (click)="openProjectCreationModal()">
        Créer un projet
      </button>
    </div>
  </div>
</nav>
<!-- Modal de création de projet -->
<div *ngIf="modal" class="custom-backdrop">
  <div class="custom-modal">
    <div class="modal-header">
      <h5 class="modal-title">Créer un projet</h5>
      <button
        type="button"
        class="btn-close"
        (click)="closeProjectCreationModal()"
      ></button>
    </div>

    <form
      [formGroup]="projectCreationForm"
      (ngSubmit)="onProjectCreationSubmit()"
      [ngClass]="{ submitted: submitted }"
    >
      <div formGroupName="projectData">
        <div class="input-group mt-3 mb-3">
          <label class="input-group-text" for="name">Nom du projet</label>
          <input
            id="inputName"
            class="form-control"
            formControlName="name"
            placeholder="Mon super projet"
            type="text"
          />
        </div>

        <div class="input-group mb-3">
          <label class="input-group-text" for="description">Description</label>
          <textarea
            id="inputDescription"
            class="form-control"
            formControlName="description"
          ></textarea>
        </div>

        <div class="input-group mb-3">
          <label class="input-group-text" for="startDate">Date de début</label>
          <input
            id="inputDate"
            class="form-control"
            formControlName="startDate"
            placeholder="2025-10-23"
            type="text"
          />
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeProjectCreationModal()">
          Annuler
        </button>
        <button class="btn btn-primary ms-3" type="submit">Valider</button>
      </div>
    </form>
  </div>
</div>

<div class="container mt-5">
  <h1 class="mb-4">Mes Projets</h1>

  <!-- Chargement -->
  <div *ngIf="loading" class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
  </div>

  <!-- Tableau des projets -->
  <div *ngIf="!loading && projects.length > 0" class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>Nom du Projet</th>
          <th>Description</th>
          <th>Date de Début</th>
          <th>Votre Rôle</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let project of projects">
          <td class="fw-bold">{{ project.name }}</td>
          <td>{{ project.description }}</td>
          <td>{{ project.startDate | date : "dd/MM/yyyy" }}</td>
          <td>
            <span>
              {{ getRoleLabel(project.contributors[0].role || "") }}
            </span>
          </td>
          <td>
            <button
              class="btn btn-sm btn-primary"
              [routerLink]="['/project', project.id]"
            >
              Voir
            </button>
            <button
              class="btn btn-sm btn-danger ms-3"
              (click)="deleteProject(project.id)"
            >
              Supprimer
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty screen projet -->
  <div
    *ngIf="!loading && projects.length === 0"
    class="alert alert-info d-flex flex-column align-items-center"
  >
    <div>
      <strong>Aucun projet</strong> - Vous n'avez aucun projet pour le moment.
    </div>
    <button class="btn btn-primary mt-2" (click)="openProjectCreationModal()">
      Créer un projet
    </button>
  </div>
</div>
