<nav class="navbar header bg-primary">
  <div class="container-fluid">
    <div>
      <button class="btn btn-danger" (click)="logOut()">Déconnexion</button>
      <button class="btn btn-light" (click)="openProjectCreationModal()">
        Créer un projet
      </button>
    </div>
  </div>
</nav>

<div class="container mt-5">
  <h1 class="mb-4">Mes Projets</h1>

  <!-- Chargement -->
  <div *ngIf="loading" class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
  </div>

  <!-- Tableau des projets -->
  <div *ngIf="!loading && projects.length > 0" class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>Nom du Projet</th>
          <th>Description</th>
          <th>Date de Début</th>
          <th>Votre Rôle</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let project of projects">
          <td class="fw-bold">{{ project.name }}</td>
          <td>{{ project.description }}</td>
          <td>{{ project.startDate | date : "dd/MM/yyyy" }}</td>
          <td>
            <span>
              {{ getUserRoleLabel(project) }}
            </span>
          </td>
          <td>
            <button
              class="btn btn-sm btn-primary"
              [routerLink]="['/project', project.id]"
            >
              Voir
            </button>
            <button
              class="btn btn-sm btn-danger ms-3"
              (click)="deleteProject(project.id)"
            >
              Supprimer
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty screen projet -->
  <div
    *ngIf="!loading && projects.length === 0"
    class="alert alert-info d-flex flex-column align-items-center"
  >
    <div>
      <strong>Aucun projet</strong> - Vous n'avez aucun projet pour le moment.
    </div>
    <button class="btn btn-primary mt-2" (click)="openProjectCreationModal()">
      Créer un projet
    </button>
  </div>
</div>

<app-project-modal
  [isOpen]="isModalOpen"
  (closed)="closeProjectCreationModal()"
  (saved)="onProjectSaved($event)"
></app-project-modal>
